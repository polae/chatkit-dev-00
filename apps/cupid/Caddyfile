# Caddyfile for Cupid
# Caddy automatically handles HTTPS with Let's Encrypt

# Production with domain (automatic HTTPS)
cupid.humorist.ai {
    # API routes go to backend
    handle /api/* {
        reverse_proxy backend:8003
    }
    handle /chatkit {
        reverse_proxy backend:8003
    }
    handle /health {
        reverse_proxy backend:8003
    }
    # Everything else goes to frontend
    handle {
        reverse_proxy frontend:80
    }
}

# Fallback for HTTP access via IP
:80 {
    # API routes go to backend
    handle /api/* {
        reverse_proxy backend:8003
    }
    handle /chatkit {
        reverse_proxy backend:8003
    }
    handle /health {
        reverse_proxy backend:8003
    }
    # Everything else goes to frontend
    handle {
        reverse_proxy frontend:80
    }
}
